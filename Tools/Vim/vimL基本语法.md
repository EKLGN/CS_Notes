# 注释

vimL用`"`作为注释符，vimL支持单行注释，不支持多行注释（块注释）。

# 变量

vimL是弱类型的脚本语言，主要有4种内置数据类型：字符串、数字、列表和字典。

## 字符串和数字



字符串使用成对的`"`或`'`包围起来，如同其他语言（bash、Ruby），`"`会对字符串中具有特殊意义的元素转义，`.`则会保存原状。

字符串仅支持字符串连接操作，字符串连接运算符表示为`.`，比如连接`"Hello"`和`"world"`。

```vim
echo "Hello" . "world"
```

vimL同时支持整数和浮点数，vimL中主要使用整数，浮点数较少使用。vimL中支持的整数范围比较小，只支持到8字节整数，如果使用大整数需要注意范围。

vimL中的字符串和数字联系非常紧密，彼此之间可以自动转换（**仅限整数**）。因为字符串支持的操作和整数支持的操作没有交集，因此可以轻易判断出是字符串转换为整数，还是整数转换为字符串。

字符串和整数的转换只支持十进制整数，其他进制的整数不会发生自动转换。字符串中如果包含数字以外的内容，只有开头数字会被转换。

```
echo "1234" . 567
-----------------------
1234567
```

```
echo "123" + 123
-----------------------
246
```

```
echo "123abc456" + 123
-----------------------
246
```

## 列表和字典

列表和字典被作为内置类型嵌入到语言中，列表使用`[]`表示，字典使用`{}`表示。

vimL的列表和字典可以保存不同类型的元素。一下定义的列表`list`和字典`dict`都是合法的。

```
" list 
let list = [1, 2, "3", [4, 5]]
" dictionary
let dict = {1:2, "hello":"world"}
```

列表使用下标访问，列表的下标从0开始，并且允许负数下标。

操作列表的函数：

- `remove(list, index)`: 删除列表`list`下标为`index`的元素
- `add(list, val)`: 在列表`list`末尾添加元素`val`

字典也使用下标访问，如果下标是整数类型，自动转换为字符串，如果同时出现字符串和数字相同的情况，vimL会认为这是相同的键而报错。

```
let dict = {1:2, "1":100}
---------------------------
E702: Dictionary 中出现相同的键"1"
```

允许使用不存在的键访问字典元素，这种操作就相当于像字典插入一个键值对。

字典的元素（键值对）使用`[key, val]`表示，比如上面代码块中`dict`的元素可以表示为`[1,2]`和`["hello", "world]`。

字典内部是无序的。



# 变量的定义与清除

命令`let`定义、修改变量,`unlet`清楚变量。

vimL中的变量是引用。vimL中的变量在Vim8.0前后有不同的行为，8.0之前变量只能将变量绑定在相同类型的对象上，而在8.0之后可以向Ruby中的变量一样任意绑定到不同类型的变量中。

### 变量的前缀（待续）

# 控制流

## 分支结构

vimL的分支结构只有`if else`语句和`? :`语句,不支持`switch`语句。

`if else`语句的格式为:

```
if [expr0]
elseif [expr1]
...
else [exprN]
endif
```

## 循环结构

vimL的循环结构只有`for ... in list`语句和`while`语句,没有C语言风格的for语句。

`for`语句结构如下：

```
for [iter] in [list]
endfor
```

因为vimL的for语句只能便力列表，所以如果要便利非列表的结构，必须先创建一个临时列表。

使用内置的`range()`函数可以实现类似与C风格的循环：

```
for i in range(10)
	echo i
endfor
-----------------------
0
1
2
3
4
5
6
7
8
9

```

如果要便利字典，需要使用`keys()`、`values()`或`items()`创建临时列表。

```
" 遍历字典
let dict = [1:2, 2:3, 3:4]
for [key, val] in items(dict)
	echo key | echo val
endfor
-----------------------------------
1
2
2
3
3
4
```

上面的代码块使用`items()`函数创建了一个以字典`dict`的元素为元素的临时列表，并将元素赋给键值对`[key, val]`，所以`key`是`dict`元素的键，`val`是`dict`元素的值。

## 循环变量的作用域

vimL中所有在函数之外定义的变量都是全局变量，所以下面的`i`具有全局作用域，离开`for`语句后还可以访问。

```
for i in range(2)
	echo i
echo i
echo g:i
echo l:i "错误，i具有全局作用域
```

在函数中定义的变量有局部作用域，如果循环变量在函数中，在离开`for`语句后仍然可以访问，但仅限该函数中。

```
function！ Foo() abort
	for i in range(2)
		echo i
	endfor
	echo i
    echo g:i	"错误，i具有局部作用域
    echo l:i
```

